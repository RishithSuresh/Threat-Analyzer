<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Threat Analyzer — dashboard for transaction monitoring, network analysis and risk profiling." />
    <title>Threat Analyzer</title>
    <!-- External libs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
    <script src="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.js" defer></script>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <div class="app">
      <aside class="sidebar">
        <div class="brand">
          <div style="width:40px;height:40px;border-radius:8px;background:#00d4ff"></div>
          <h1>Threat Analyzer</h1>
        </div>
        <nav class="nav">
          <button data-view="dashboard" class="active">Dashboard</button>
          <button data-view="transactions">Transaction Monitor</button>
          <button data-view="network">Network Analysis</button>
          <button data-view="risk">Risk Profiling</button>
          <button data-view="patterns">Pattern Analysis</button>
        </nav>
        <div style="margin-top:auto;font-size:12px;color:rgba(255,255,255,0.6)">v1.0.0 • System Active</div>
      </aside>

      <main class="main">
        <!-- Dashboard -->
        <section id="dashboard" class="view">
          <div class="header"><h1>Threat Analyzer Dashboard</h1><p>Real-time Money Laundering Detection & Risk Assessment</p></div>
          <div class="metrics">
            <div class="card"><strong>Active Alerts</strong><div id="activeAlerts" style="font-size:22px;margin-top:8px;color:#ff6b6b">—</div></div>
            <div class="card"><strong>High-Risk Accounts</strong><div id="highRiskAccounts" style="font-size:22px;margin-top:8px;color:#ffa500">—</div></div>
            <div class="card"><strong>Flagged Transactions</strong><div id="flaggedTx" style="font-size:22px;margin-top:8px;color:#9b59b6">—</div></div>
            <div class="card"><strong>Monitored Accounts</strong><div id="monitoredAccounts" style="font-size:22px;margin-top:8px;color:#3498db">—</div></div>
          </div>

          <div class="charts">
            <div class="card">
              <h3>Transaction Volume & Risk Trends</h3>
              <canvas id="lineChart" height="200"></canvas>
            </div>
            <div class="card">
              <h3>Risk Distribution</h3>
              <canvas id="barChart" height="200"></canvas>
            </div>
          </div>

          <div class="card" style="margin-top:16px">
            <h3>Recent Alerts</h3>
            <table class="table">
              <thead><tr><th>Account</th><th>Message</th><th>Amount</th><th>Severity</th></tr></thead>
              <tbody>
                <tr><td>ACC-2024-001</td><td>Rapid fund transfer across jurisdictions</td><td>$125,000</td><td style="color:#ff6b6b">HIGH</td></tr>
                <tr><td>ACC-2024-015</td><td>Multiple small transactions</td><td>$89,500</td><td style="color:#ffa500">MED</td></tr>
                <tr><td>ACC-2024-042</td><td>Shell company payment detected</td><td>$245,000</td><td style="color:#ff6b6b">HIGH</td></tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- Transactions -->
        <section id="transactions" class="view" style="display:none">
          <div class="header"><h1>Transaction Monitoring System</h1><p>Real-time analysis of transactions</p></div>
          <div class="card" style="margin-top:12px">
            <h3>Transactions</h3>
              <!-- Upload UI removed per user request -->
              <table class="table" id="txTable">
              <thead><tr><th>ID</th><th>Date</th><th>From</th><th>To</th><th>Amount</th><th>Risk</th><th>Status</th></tr></thead>
              <tbody></tbody>
            </table>
              <div id="analysisResults" style="margin-top:12px">
                <!-- Summary cards will be injected here by app.js -->
                <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:8px" id="analysisSummary"></div>
                <!-- Graphs removed from Transaction Monitor per user request -->
              </div>
          </div>
        </section>

        <!-- Network -->
        <section id="network" class="view" style="display:none">
          <div class="header"><h1>Network Analysis & Money Trail</h1><p>Interactive spider map showing transaction layers</p></div>
          <div class="network-container card" style="margin-top:12px;padding:12px">
            <div style="display:flex;gap:12px;align-items:flex-start">
              <div id="networkViz" style="flex:1;min-width:200px;height:500px"></div>
              <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-start">
                <div style="background:#fff;padding:8px;border-radius:6px;box-shadow:0 1px 6px rgba(0,0,0,0.06);font-size:13px">
                  <strong>Legend</strong>
                  <div style="margin-top:6px">→ Arrow: transaction direction</div>
                  <div style="display:flex;gap:8px;align-items:center"><span style="display:inline-block;width:12px;height:12px;background:#9aa0a6;border-radius:3px"></span><span>Small amount</span></div>
                  <div style="display:flex;gap:8px;align-items:center"><span style="display:inline-block;width:12px;height:12px;background:#ffa500;border-radius:3px"></span><span>Medium amount</span></div>
                  <div style="display:flex;gap:8px;align-items:center"><span style="display:inline-block;width:12px;height:12px;background:#ff6b6b;border-radius:3px"></span><span>Large amount</span></div>
                  <div>• IP shown on edge label / tooltip</div>
                </div>
                <div style="background:#fff;padding:8px;border-radius:6px;box-shadow:0 1px 6px rgba(0,0,0,0.06);font-size:13px">
                  <label style="display:flex;align-items:center;gap:8px"><input type="checkbox" id="togglePulse" checked> Pulse sink nodes on select</label>
                  <label style="display:flex;align-items:center;gap:8px;margin-top:6px"><input type="checkbox" id="toggleFlow" checked> Animate flow particles</label>
                </div>
              </div>
              <div id="nodeDetails" style="width:320px;max-width:40%;">
                <div class="card">
                  <h3>Account Details</h3>
                  <div id="nodeDetailsContent" style="font-size:14px;color:#222;padding:6px">Click a node to see details</div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Risk -->
        <section id="risk" class="view" style="display:none">
          <div class="header"><h1>Risk-Based Customer Profiling</h1><p>AI-powered risk assessment</p></div>
          <div class="card" style="margin-top:12px">
            <h3>Customer Profiles</h3>
            <div class="risk-controls" style="display:flex;gap:10px;align-items:center;margin-top:10px">
              <input id="riskSearch" placeholder="Search account or ID..." style="flex:1;padding:8px;border-radius:8px;border:1px solid #e6e9ee;font-size:14px">
              <select id="riskSort" style="padding:8px;border-radius:8px;border:1px solid #e6e9ee;font-size:14px">
                <option value="volume">Sort: Volume</option>
                <option value="risk">Sort: Avg Risk</option>
                <option value="tx">Sort: Tx Count</option>
              </select>
              <select id="riskPageSize" style="padding:8px;border-radius:8px;border:1px solid #e6e9ee;font-size:14px">
                <option value="12">12 / page</option>
                <option value="24">24 / page</option>
                <option value="48">48 / page</option>
              </select>
              <button id="exportRiskBtn" style="padding:8px 10px;border-radius:8px;border:1px solid #e6e9ee;background:var(--accent);color:#032;cursor:pointer">Export CSV</button>
            </div>
            <div id="riskProfiles" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;margin-top:12px">
              <!-- Risk profile cards injected here -->
            </div>
          </div>
        </section>

        <!-- Patterns -->
        <section id="patterns" class="view" style="display:none">
          <div class="header"><h1>Pattern Analysis & Behavioral Detection</h1><p>Identification of money laundering patterns</p></div>
          <div class="card" style="margin-top:12px">
            <h3>Detected Patterns</h3>
            <table class="table">
              <thead><tr><th>ID</th><th>Name</th><th>Severity</th><th>Confidence</th><th>Actions</th></tr></thead>
              <!-- Added Actions column for pattern interactions -->
              <tbody id="patternsBody">
              </tbody>
            </table>
          </div>
        </section>
      </main>
    </div>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="app.js" defer></script>
  </body>
</html>
